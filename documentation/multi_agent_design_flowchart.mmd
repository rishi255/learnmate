---
config:
  layout: dagre
---
flowchart TD
     %% Main Flow
    start([start]) --> A["User Input Node<br><i>Get Topic</i>"]
    A --> B["Research Agent"]
    
    %% Research Agent
    subgraph B["Research Agent"]
        direction TB
        B1["Initial Research<br><i>Web Search & Overview</i>"] --> B2["Deep Research<br><i>Key Concepts & Visuals</i>"]
    end
    B --> P["Planner Agent"]

    %% Planner Agent
    subgraph P["Planner Agent"]
        P1["Structure Planning<br><i>Sections & Visuals</i>"]
    end

    %% Parallel Paths
    P --> ContentPath & VisualPath

    %% Content Generation Path
    subgraph ContentPath["Content Generation"]
        C["Content Writer Agent"] --> CV["Content Validator<br><i>(Future)</i>"]
        CV -..-> |Feedback| C
    end

    %% Visual Generation Path
    subgraph VisualPath["Visuals Generation"]
        M["Design Coder Agent"] --> MV["Mermaid Validator<br><i>(Future)</i>"]
        MV -..-> |Feedback| M
    end

    %% Merge and Finalize
    ContentPath & VisualPath --> merge["Merge Node<br><i>Combine Content & Visuals</i>"]

    merge --> exit["Exit Node"]
    exit --> endnode([end])

    %% Styling
    classDef future fill:#ffe6e6,stroke:#333
    classDef state fill:#e6ffe6,stroke:#333,stroke-dasharray: 5 5
    class CV,MV future
    class save1,save2,save3,save4a,save4b,save5 state
    style ContentPath fill:#f5f0ff,stroke:#333
    style VisualPath fill:#f0f5ff,stroke:#333
